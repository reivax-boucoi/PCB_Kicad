Version 4
SHEET 1 3940 680
WIRE 2576 -80 2544 -80
WIRE 2672 -80 2640 -80
WIRE 2720 -80 2672 -80
WIRE 2800 -80 2784 -80
WIRE 2912 -80 2800 -80
WIRE 3088 -80 2912 -80
WIRE 3168 -80 3088 -80
WIRE 2672 -48 2672 -80
WIRE 3168 -48 3168 -80
WIRE 2800 -32 2800 -80
WIRE 2384 64 2240 64
WIRE 2432 64 2384 64
WIRE 2544 64 2544 -80
WIRE 2544 64 2496 64
WIRE 2592 64 2544 64
WIRE 2672 64 2672 16
WIRE 2672 64 2656 64
WIRE 2800 64 2800 32
WIRE 2544 80 2544 64
WIRE 2240 160 2240 144
WIRE 2544 160 2544 144
WIRE 2544 160 2240 160
WIRE 2672 160 2672 128
WIRE 2672 160 2544 160
WIRE 2752 160 2672 160
WIRE 2784 160 2752 160
WIRE 2960 160 2784 160
WIRE 3184 160 3056 160
WIRE 3312 160 3184 160
WIRE 3520 160 3312 160
WIRE 2544 192 2544 160
WIRE 2672 192 2672 160
WIRE 2384 256 2384 64
WIRE 2432 256 2384 256
WIRE 2544 256 2496 256
WIRE 2560 256 2544 256
WIRE 2672 256 2624 256
WIRE 3184 256 3184 160
WIRE 2784 272 2784 240
WIRE 2832 272 2784 272
WIRE 2944 272 2832 272
WIRE 3040 272 3040 208
WIRE 3040 272 3024 272
WIRE 2672 288 2672 256
WIRE 3040 320 3040 272
WIRE 3184 368 3184 336
WIRE 3184 368 3104 368
WIRE 3184 416 3184 368
WIRE 3040 448 3040 416
WIRE 3184 512 3184 496
FLAG 2752 160 Vout2
FLAG 3520 240 0
FLAG 3168 32 0
FLAG 3088 -80 Vled2
FLAG 2912 -16 0
FLAG 2672 288 0
FLAG 3040 512 0
FLAG 3184 512 0
FLAG 3312 224 0
FLAG 2832 336 0
SYMBOL voltage 2240 48 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 -12 213 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 13 182 VTop 2
SYMATTR InstName V3
SYMATTR Value SINE(0 17.2 50)
SYMATTR SpiceLine Rser=8
SYMBOL current 3520 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I5
SYMATTR Value PULSE(20m 35m 1.7 1n 1n 100m)
SYMBOL current 3168 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I6
SYMATTR Value {Iled}
SYMBOL cap 2896 -80 R0
SYMATTR InstName C13
SYMATTR Value 220µ
SYMBOL cap 2656 192 R0
SYMATTR InstName C15
SYMATTR Value {Cv}
SYMBOL cap 2496 240 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C16
SYMATTR Value {Cv}
SYMBOL diode 2720 -64 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D18
SYMATTR Value 1N4148
SYMBOL cap 2496 48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C17
SYMATTR Value {Cb}
SYMBOL cap 2640 -96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C18
SYMATTR Value {Cb}
SYMBOL cap 2656 64 R0
SYMATTR InstName C19
SYMATTR Value {Cb}
SYMBOL diode 2592 80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D13
SYMATTR Value 1N4148
SYMBOL diode 2624 240 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D14
SYMATTR Value 1N4148
SYMBOL diode 2560 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D15
SYMATTR Value 1N4148
SYMBOL diode 2560 144 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D16
SYMATTR Value 1N4148
SYMBOL diode 2688 16 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D17
SYMATTR Value 1N4148
SYMBOL npn 3104 320 M0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL zener 3056 512 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N750
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3168 400 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 3168 240 R0
SYMATTR InstName R3
SYMATTR Value 15k
SYMBOL cap 3296 160 R0
SYMATTR InstName C1
SYMATTR Value 60µ
SYMBOL nmos 2960 208 R270
SYMATTR InstName M1
SYMATTR Value QS6K21
SYMBOL res 2768 144 R0
SYMATTR InstName R1
SYMATTR Value 2k2
SYMBOL res 3040 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 2k2
SYMBOL cap 2816 272 R0
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL cap 2784 -32 R0
SYMATTR InstName C4
SYMATTR Value {Cb}
TEXT 2480 440 Left 2 ;.step param Iled list 0m 15m 20m
TEXT 2184 488 Left 2 !.tran 2
TEXT 2368 504 Left 2 !.param Cv=470u Cb=470u Iled=15m Isup=20m
TEXT 2496 464 Left 2 ;.step param Isup list 0m 20m 40m
